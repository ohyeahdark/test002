generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum EmployeeStatus {
  ACTIVE
  INACTIVE
  ON_LEAVE
}

enum Role {
  ADMIN
  USER
}

// Model mới cho Phòng ban
model Department {
  id        String     @id @default(uuid())
  name      String     @unique
  employees Employee[] // Một phòng ban có nhiều nhân viên
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
}

// Model mới cho Chức vụ
model Position {
  id        String     @id @default(uuid())
  name      String
  employees Employee[] // Một chức vụ có nhiều nhân viên
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
}

// Model Employee được cập nhật với các mối quan hệ
model Employee {
  id           String         @id @default(uuid())
  name         String
  email        String         @unique
  phone        String?
  avatarUrl    String?
  bio          String?
  
  // Mối quan hệ với Position
  position     Position @relation(fields: [positionId], references: [id])
  positionId   String

  // Mối quan hệ với Department
  department   Department @relation(fields: [departmentId], references: [id])
  departmentId String
 
  user         User?
  
  addressLine1 String?
  addressCity  String?
  addressCountry String?

  status       EmployeeStatus @default(ACTIVE)
  dateOfBirth  DateTime?
  hireDate     DateTime       @default(now())

  createdAt    DateTime       @default(now())
  updatedAt    DateTime       @updatedAt
}

model User {
  id           String   @id @default(uuid())
  username     String   @unique
  password     String
  role         String   @default("user")
  refreshToken  String?  @db.Text
  employee     Employee? @relation(fields: [employeeId], references: [id])
  employeeId   String?   @unique
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}